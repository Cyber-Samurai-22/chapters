This is chapter number three and these changes I have made on a second branch.